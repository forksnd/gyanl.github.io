<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {%- seo -%}
  <link rel="shortcut icon" type="image/x-icon" href="assets/favicon.ico">
  <link rel="stylesheet" href="{{ "/assets/css/style.css" | relative_url }}">
  {%- feed_meta -%}
  {%- if jekyll.environment == 'production' and site.google_analytics -%}
    {%- include google-analytics.html -%}
  {%- endif -%}

  {% if site.tags != "" %}
    {% include collecttags.html %}
  {% endif %}
  <script>

    // var currentDate = new Date();
    // var minute = currentDate.getMinutes();

    // // Set random color theme
    // var r = document.querySelector(':root');
    // var rs = getComputedStyle(r);
    // var randomHue = minute * 6;

    // var genAccent = "hsl(" + randomHue + ", 80%, 40%)";
    // var genAccentDark = "hsl(" + randomHue + ", 50%, 35%)";
    // var genAccentLight = "hsla(" + randomHue + ", 20%, 70%, 25%)";

    // r.style.setProperty('--accent-color', genAccent);
    // r.style.setProperty('--accent-color-light', genAccentLight);
    // r.style.setProperty('--accent-color-dark', genAccentDark);


  function getCookie(cname) {
  let name = cname + "=";
  let ca = document.cookie.split(';');
  for(let i = 0; i < ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

function updateThemeCookie(theme){
    var newCookie = document.cookie;
    var searchString = "theme=";
    var searchPosition = newCookie.indexOf(searchString);
    console.log("newCookie:" + newCookie);
    console.log("Search Position:" + searchPosition);
    if (searchPosition>0) {
      newCookie = newCookie.substring(0, searchPosition);
      console.log("Substring position was: " + searchPosition + ". New Cookie: " + document.cookie)
    }
    document.cookie = newCookie + "; theme=" + theme;
    console.log("After update cookie: " + document.cookie);
  }

function setColorTheme(theme) {

      var r = document.querySelector(':root');

      switch (theme) {
    case "0":
        var genAccent = "rgb(255 31 82)";
        var genAccentDark = "rgb(205 55 75)";
        var genAccentLight = "rgb(255 86 55 / 15%)";
        r.style.setProperty('--base-font-family', 'Helvetica');
        break;

    case "1":
        var genAccent = "hsl(" + 25 + ", 80%, 40%)";
        var genAccentDark = "hsl(" + 25 + ", 50%, 35%)";
        var genAccentLight = "hsla(" + 25 + ", 20%, 70%, 25%)";
        break;

    case "2":
        var genAccent = "hsl(" + 60 + ", 80%, 40%)";
        var genAccentDark = "hsl(" + 60 + ", 50%, 35%)";
        var genAccentLight = "hsla(" + 60 + ", 20%, 70%, 25%)";
        break;

    case "3":
        var genAccent = "hsl(" + 170 + ", 80%, 40%)";
        var genAccentDark = "hsl(" + 170 + ", 50%, 35%)";
        var genAccentLight = "hsla(" + 170 + ", 20%, 70%, 25%)";
        break;

    case "4":
        var genAccent = "hsl(" + 245 + ", 80%, 40%)";
        var genAccentDark = "hsl(" + 245 + ", 50%, 35%)";
        var genAccentLight = "hsla(" + 245 + ", 20%, 70%, 25%)";
        break;

    default:
        console.log("Invalid input to setColorTheme");
    }
    
    r.style.setProperty('--accent-color', genAccent);
    r.style.setProperty('--accent-color-light', genAccentLight);
    r.style.setProperty('--accent-color-dark', genAccentDark);
    console.log("Page theme set to " + theme);

    updateThemeCookie(theme);

  }

  let savedTheme = getCookie("theme");
  if (savedTheme != "") {
   setColorTheme(savedTheme);
   console.log("Theme cookie was: " + savedTheme);
  } else {
    setColorTheme(0);
    console.log("No theme cookie found, value:" + savedTheme);
    }

    </script>
</head>
